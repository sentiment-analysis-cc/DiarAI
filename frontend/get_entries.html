<html>

<head>

    <link rel="stylesheet" href="css/style.css" />

    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script> 
    <script src="js/lib/amazon-cognito-auth.min.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1162.0.min.js"></script>
    <script src="js/lib/amazon-cognito-identity.min.js"></script>  
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/get_entries.js"></script>
    <script>
        
        // Check if user is already logged in before loading the other content
        window.onload = function() {
            
            var cognitoUser = getCurrentUser();
            //console.log(cognitoUser);
            if (cognitoUser == null) {
                window.location.href = "login.html";
            }
            
            var username = cognitoUser.username;
            
            //console.log(username);
            
            var postData = {
                "username": username,
                "type" : "all",
            };
            
            // spara brutalmente verso aws
            // TO-DO: fare con post
            let data = $.ajax({
                type: "GET",
                url: _config.lambda_entries_url,
                data: postData,
                success: function(data) {
                    generateTable(data);                    
                },
                error: function(data) {
                    //console.log(data);
                    alert("Some error occurred :(\n" + data);
                }
            });    
        }
    </script>
</head>

<body>

    <div class="topnav">
        <a href="submitdiary.html">New Entry</a>
        <a class="active" href="get_entries.html">See Entries</a>
        <a href="graph.html">See Graph</a>
        <a onclick="logout()" href="#">Log Out</a>
      </div>
    
    
      <h1>All your diary entries</h1>

    <table id="table"></table>
    
</body>      

</html>